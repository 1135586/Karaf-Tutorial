<?xml version="1.0" encoding="UTF-8"?>
<features name="tasklist-cdi-${pom.version}" xmlns="http://karaf.apache.org/xmlns/features/v1.2.1">

    <repository>mvn:org.ops4j.pax.jdbc/pax-jdbc-features/0.7.0/xml/features</repository>
    <!-- <repository>mvn:org.ops4j.pax.jdbc/pax-jdbc-features/0.7.0/xml/features</repository>  -->
    <repository>mvn:org.apache.cxf.dosgi/cxf-dosgi/1.7.0/xml/features</repository>
    
    <!-- For hibernate 5.0.6.Final we need a patched feature.
         See https://hibernate.atlassian.net/browse/HHH-10432
    -->
    <feature name='hibernate-orm' version="5.0.6.patch1">
        <bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.antlr/2.7.7_5</bundle>
        <bundle dependency="true">mvn:org.jboss.logging/jboss-logging/3.3.0.Final</bundle>
        <bundle dependency="true">mvn:org.hibernate.javax.persistence/hibernate-jpa-2.1-api/1.0.0.Final</bundle>
        <bundle dependency="true">mvn:org.javassist/javassist/3.18.1-GA</bundle>
        <bundle dependency="true">mvn:org.jboss/jandex/2.0.0.Final</bundle>
        <bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.dom4j/1.6.1_5</bundle>
        <bundle dependency="true">mvn:org.hibernate.common/hibernate-commons-annotations/5.0.1.Final</bundle>
        <bundle dependency="true">mvn:org.apache.geronimo.specs/geronimo-jta_1.1_spec/1.1.1</bundle>
        <bundle>mvn:org.hibernate/hibernate-core/5.0.6.Final</bundle>
        <bundle>mvn:org.hibernate/hibernate-entitymanager/5.0.6.Final</bundle>
        <bundle>mvn:org.hibernate/hibernate-osgi/5.0.6.Final</bundle>
    </feature>

    <feature name="example-tasklist-ds" version="${pom.version}">
        <feature>example-tasklist-ds-persistence</feature>
        <feature>example-tasklist-ds-service</feature>
        <feature>example-tasklist-ds-ui</feature>
    </feature>

    <feature name="example-tasklist-ds-persistence" version="${pom.version}">
        <feature>scr</feature>
        <feature>transaction</feature>
        <feature>jpa</feature>
        <feature version="[5,6)">hibernate-orm</feature>
        <feature>pax-jdbc-h2</feature>
        <feature>pax-jdbc-config</feature>
        <feature>pax-jdbc-pool-dbcp2</feature>
        <bundle>mvn:${groupId}/model/${pom.version}</bundle>
        <bundle>mvn:${groupId}/persistence/${pom.version}</bundle>
    </feature>

    <feature name="example-tasklist-ds-service" version="${pom.version}">
        <feature>scr</feature>
        <feature>cxf-dosgi-discovery-distributed</feature>
        <bundle>mvn:${groupId}/model/${pom.version}</bundle>
        <bundle>mvn:${groupId}/service/${pom.version}</bundle>
    </feature>

    <feature name="example-tasklist-ds-ui" version="${pom.version}">
        <feature>scr</feature>
        <feature>http-whiteboard</feature>
        <feature>persistence-api</feature>
        <bundle>mvn:${groupId}/model/${pom.version}</bundle>
        <bundle>mvn:${groupId}/ui/${pom.version}</bundle>
    </feature>

</features>
